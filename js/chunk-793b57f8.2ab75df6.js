(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-793b57f8"],{"00db":function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return h}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sh-upload"},[a("Input",{staticStyle:{display:"none"},attrs:{type:"text",value:e.value}}),e._l(e.uploadList,(function(t,i){return a("div",{key:i,staticClass:"uploadlist",style:e.upStyles},["finished"===t.status?[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.$config.baseUrl.dev+t.response.content,expression:"$config.baseUrl.dev + item.response.content"}]}),a("div",{staticClass:"uploadlistcover"},[a("Icon",{attrs:{type:"ios-eye-outline"},on:{click:function(a){return e.handleView(e.$config.baseUrl.dev+t.response.content)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},on:{click:function(a){return e.handleRemove(t)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,showInfo:!1}}):e._e()]],2)})),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploadList.length<e.filelength,expression:"uploadList.length < filelength"}]},[a("Upload",{ref:"upload",staticClass:"imageupload",attrs:{disabled:e.disabled,multiple:e.multiple,name:e.filename,"show-upload-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,accept:e.uploadaccept,format:e.messageAll.fileFormat,"before-upload":e.handleBeforeUpload,action:e.baseUpload}},[a("div",{staticClass:"sh-uploadwrapper",style:e.upStyles},[a("Icon",{attrs:{type:"md-camera"}})],1)])],1),a("Modal",{attrs:{title:"查看图片",footer:null},on:{"on-cancel":e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgUrl,expression:"imgUrl"}],staticStyle:{width:"100%"}}):e._e()])],2)},l=[],s=(a("3721"),a("3221"),a("310b"),a("8445"),a("dd4d"),a("d104"),a("1ff6"),{props:{multiple:Boolean,disabled:Boolean,value:{type:String,default:""},filename:{type:String,default:"image"},fileaccept:{type:String,default:"jpg,jpeg,png"},filelength:{type:Number,default:1},width:{type:Number,default:80},height:{type:Number,default:80}},name:"sh-img-upload",data:function(){return{baseUpload:this.$config.baseUrl.dev+"/putFile",imgName:"",imgUrl:"",visible:!1,resultUrl:"",uploadList:[]}},created:function(){},mounted:function(){},computed:{upStyles:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}},messageAll:function(){return{limitBytes:2097152,fileSizeError:"图片大小不能超过2M",fileFormat:this.fileaccept.split(","),fileTypeError:"图片格式不正确，请上传"+this.fileaccept+"文件"}},uploadaccept:function(){var e=[];return this.fileaccept.split(",").forEach((function(t){e.push("."+t)})),e.join(",")}},methods:{handleView:function(e){this.imgUrl=e,this.visible=!0},handleCancel:function(){this.visible=!1},handleRemove:function(e){var t=this,a=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(a.indexOf(e),1),this.$nextTick((function(){t.uploadList=[],t.resultUrl=""}))},handleSuccess:function(e,t){var a=this;"200"==e.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.resultUrl=a.uploadList[0].response.content})):0==e.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.resultUrl=e.path})):(this.$nextTick((function(){a.$refs.upload.fileList=[],a.uploadList=[],a.resultUrl=""})),this.msgwarning({content:e.content?e.content:"上传失败！"}))},handleError:function(e,t,a){this.msgerror("上传失败！")},handleBeforeUpload:function(e){var t=e.name.substr(e.name.lastIndexOf(".")).toLowerCase(),a=t.split(".")[1],i=this.messageAll.fileFormat,l=i.some((function(e){return e===a}));if(""!=this.fileaccept&&!l)return this.msginfo({content:this.messageAll.fileTypeError}),!1;var s=e.size<this.messageAll.limitBytes;return!!s||(this.msginfo({content:this.messageAll.fileSizeError}),!1)},handleUpload:function(e){var t=this,a=new FormData;a.append("file",e),uploadImgOne(a).then((function(e){t.handleSuccess(e)}))}},watch:{value:{handler:function(e,t){e&&(this.uploadList=[{status:"finished",response:{content:e}}],this.resultUrl=e)},immediate:!0},resultUrl:function(e){this.$emit("input",e)}}}),n=s,r=(a("4e1e"),a("5d22")),o=Object(r["a"])(n,i,l,!1,null,"365f43f6",null),u=o.exports,c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sh-upload"},[a("Input",{staticStyle:{display:"none"},attrs:{type:"text",value:e.inputVal}}),e.uploadList.length>0?e._l(e.uploadList,(function(t,i){return a("div",{key:i,staticClass:"uploadlist uploadlistfile",style:e.upStyles},["finished"===t.status?[a("div",{staticClass:"uploadlist-item"},[a("div",{staticClass:"title"},[e._v(e._s(t.response.content))]),a("Icon",{attrs:{type:"ios-trash-outline",title:"删除文件",size:"18"},on:{click:function(a){return e.handleRemove(t)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,showInfo:!1}}):e._e()]],2)})):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.uploadList.length<e.maxfilelength,expression:"uploadList.length < maxfilelength"}]},[a("Upload",{ref:"upload",staticClass:"fileupload",attrs:{disabled:e.disabled,multiple:e.multiple,name:e.filename,"show-upload-list":!1,"on-success":e.handleSuccess,"on-error":e.handleError,accept:e.uploadaccept,format:e.messageAll.fileFormat,"before-upload":e.handleBeforeUpload,action:e.baseUpload}},[a("div",{staticClass:"sh-uploadwrapper",style:e.upStyles},[a("Icon",{attrs:{type:"md-add"}})],1)])],1)],2)},d=[],m={props:{multiple:Boolean,disabled:Boolean,value:{type:[String,Array],default:""},filename:{type:String,default:"image"},fileaccept:{type:String,default:""},maxfilelength:{type:Number,default:3},width:{type:Number,default:60},height:{type:Number,default:60}},name:"sh-file-upload",data:function(){return{baseUpload:this.$config.baseUrl.dev+"/putFile",visible:!1,uploadList:[],resultUrl:[]}},created:function(){},mounted:function(){},computed:{inputVal:function(){return this.resultUrl.length>0?JSON.stringify(this.resultUrl):void 0},upStyles:function(){return{minWidth:"".concat(this.width,"px"),minHeight:"".concat(this.height,"px")}},messageAll:function(){return{limitBytes:20971520,fileSizeError:"文件大小不能超过20M",fileType:this.fileaccept.split(","),fileTypeError:"文件格式不正确，请上传"+this.fileaccept+"文件"}},uploadaccept:function(){var e=[];return this.fileaccept.split(",").forEach((function(t){e.push("."+t)})),e.join(",")}},methods:{handleRemove:function(e){var t=this.$refs.upload.fileList,a=t.indexOf(e);this.$refs.upload.fileList.splice(a,1),this.uploadList.splice(a,1),this.resultUrl.splice(a,1)},handleBeforeUpload:function(e){var t=e.name.substr(e.name.lastIndexOf(".")).toLowerCase(),a=t.split(".")[1],i=this.messageAll.fileType,l=i.some((function(e){return e===a}));if(""!=this.fileaccept&&!l)return this.msginfo({content:this.messageAll.fileTypeError}),!1;var s=e.size<this.messageAll.limitBytes;return!!s||(this.msginfo({content:this.messageAll.fileSizeError}),!1)},handleSuccess:function(e,t){var a=this;"200"==e.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.resultUrl=[],a.uploadList.forEach((function(e){a.resultUrl.push(e.response.content)}))})):this.msgwarning({content:e.content?e.content:"上传失败！"})},handleError:function(e,t,a){this.msgerror("上传失败！")},blur:function(){this.$refs.input.blur()}},watch:{value:{handler:function(e,t){var a=this;e&&(this.uploadList=[],e.forEach((function(e){a.uploadList.push({status:"finished",response:{content:e}})})),this.resultUrl=e)},immediate:!0},resultUrl:function(e){this.$emit("input",e)}}},f=m,p=(a("a2e0"),Object(r["a"])(f,c,d,!1,null,"492600f5",null)),h=p.exports},"0740":function(e,t,a){},"25eb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sh-content"},[a("div",{staticClass:"container"},[a("ShHeader",{attrs:{type:"border",title:"素材管理",ghost:""}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("Form",{attrs:{inline:""}},[a("FormItem",{staticClass:"mb-0"},[a("Input",{directives:[{name:"input-filter",rawName:"v-input-filter"}],attrs:{type:"text",search:"",placeholder:"请输入资源名称",clearable:""},model:{value:e.searchname,callback:function(t){e.searchname="string"===typeof t?t.trim():t},expression:"searchname"}})],1),"materialMy"==e.courseTabActive?a("FormItem",{staticClass:"mb-0 mr-0"},[a("Button",{attrs:{type:"primary"},on:{click:e.handleMaterialCreate}},[e._v("添加资源")])],1):e._e()],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"sh-content-bg1"},[a("Tabs",{staticClass:"sh-tab reverse",attrs:{value:e.courseTabActive},on:{"on-click":e.handleTab}},e._l(e.tabList,(function(e,t){return a("TabPane",{key:t,attrs:{label:e.label,name:e.name}})})),1),a("div",{staticClass:"px-4"},[a("MaterialList",{ref:"materiallist",attrs:{searchname:e.searchname,materialName:e.courseTabActive}})],1)],1)])])],1)])},l=[],s=(a("1327"),a("1ff6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ShList",{attrs:{grid:{gutter:20,xs:24,sm:12,md:8,lg:6},dataSourse:e.searchList,loading:e.dataloading,pagination:e.pagination},scopedSlots:e._u([{key:"renderItem",fn:function(t){var i=t[0];return a("ListItem",{},[a("div",{staticClass:"materialitem"},[a("div",{staticClass:"image"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.materialImage,expression:"item.materialImage"}]})]),a("div",{staticClass:"content"},[a("div",{staticClass:"header"},[e._v(e._s(i.materialTitle))]),a("div",{staticClass:"meta"},[a("span",{},[e._v("资源类型："+e._s(i.materialType))])]),a("div",{staticClass:"description"},[e._v(e._s(i.materialIntroduce))])]),a("div",{staticClass:"footer"},[a("Button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.handleMaterialEdit(i)}}},[e._v("编辑")]),a("Button",{attrs:{type:"default",size:"small"},nativeOn:{click:function(t){return e.handleMaterialInfo(i)}}},[e._v("查看")])],1)])])}}])}),a("MaterialModal",{attrs:{title:e.modalTitle,formfields:e.editItem,loading:e.modalLoading,visible:e.modalVisible},on:{handleCancel:e.handleCancel,handleOk:e.handleOk}})],1)}),n=[],r=a("efe2"),o=(a("6706"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{attrs:{width:"900px",value:e.visible,title:e.title,"mask-closable":!1,loading:!0,"footer-hide":""},on:{"on-cancel":e.handleCancel}},[a("ShLoading",{attrs:{loading:e.loading}}),e.visible?a("MaterialForm",{staticStyle:{"max-width":"700px",margin:"20px auto"},attrs:{formfields:e.formfields},on:{"on-success-valid":e.handleSubmit,"on-cancel":e.handleCancel}}):e._e()],1)],1)}),u=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{ref:"materialForm",staticClass:"materialForm",attrs:{model:e.materialForm,rules:e.materialRules,"label-width":130,"label-colon":""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmit(t)}}},[a("FormItem",{attrs:{label:"资源封面",prop:"materialImage"}},[a("ShImgUpload",{attrs:{width:260,height:150},model:{value:e.materialForm.materialImage,callback:function(t){e.$set(e.materialForm,"materialImage","string"===typeof t?t.trim():t)},expression:"materialForm.materialImage"}})],1),a("FormItem",{attrs:{label:"资源名称",prop:"materialTitle"}},[a("Input",{directives:[{name:"input-filter",rawName:"v-input-filter:trim",arg:"trim"}],attrs:{size:e.size,placeholder:"请输入资源名称"},model:{value:e.materialForm.materialTitle,callback:function(t){e.$set(e.materialForm,"materialTitle","string"===typeof t?t.trim():t)},expression:"materialForm.materialTitle"}})],1),a("FormItem",{attrs:{label:"资源类型",prop:"materialTypes"}},[a("Select",{attrs:{size:e.size,placeholder:"请选择资源类型"},model:{value:e.materialForm.materialTypes,callback:function(t){e.$set(e.materialForm,"materialTypes","string"===typeof t?t.trim():t)},expression:"materialForm.materialTypes"}},[a("Option",{attrs:{value:"1"}},[e._v("1")]),a("Option",{attrs:{value:"2"}},[e._v("2")])],1)],1),a("FormItem",{attrs:{label:"是否对学生公开",prop:"materialPublic"}},[a("RadioGroup",{model:{value:e.materialForm.materialPublic,callback:function(t){e.$set(e.materialForm,"materialPublic","string"===typeof t?t.trim():t)},expression:"materialForm.materialPublic"}},[a("Radio",{staticClass:"mr-4",attrs:{label:1}},[e._v("是")]),a("Radio",{staticClass:"mr-4",attrs:{label:2}},[e._v("否")])],1)],1),a("FormItem",{attrs:{label:"附件上传",prop:"materialFiles"}},[a("ShFileUpload",{model:{value:e.materialForm.materialFiles,callback:function(t){e.$set(e.materialForm,"materialFiles","string"===typeof t?t.trim():t)},expression:"materialForm.materialFiles"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary",size:e.size},on:{click:e.handleSubmit}},[e._v("确定")]),a("Button",{attrs:{type:"default",size:e.size},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1)},d=[],m=(a("8445"),a("0f1b"),a("00db")),f=(a("0740"),{name:"material-form",props:{size:{type:String,default:"default"},formfields:{type:Object,default:function(){}}},components:{ShImgUpload:m["b"],ShFileUpload:m["a"]},data:function(){return{materialForm:{materialImage:null,materialTitle:null,materialTypes:null,materialPublic:null,materialFiles:[]}}},computed:{materialRules:function(){return{materialImage:[{required:!0,type:"string",message:"请选择资源封面",trigger:"change"}],materialTitle:[{required:!0,type:"string",message:"请输入资源名称",trigger:"blur"}],materialTypes:[{required:!0,type:"string",message:"请选择资源类型",trigger:"change"}],materialPublic:[{required:!0,type:"number",message:"请选择是否对学生公开",trigger:"change"}],materialFiles:[{required:!0,type:"array",message:"请上传附件",trigger:"change"}]}}},mounted:function(){this.readEditFields()},methods:{readEditFields:function(){var e=this;if(void 0==this.formfields)return!1;Object.keys(this.materialForm).forEach((function(t){e.formfields[t]&&(e.materialForm[t]=e.formfields[t])}))},handleSubmit:function(){var e=this;return e.$refs.materialForm.validate((function(t){t?e.$emit("on-success-valid",e.materialForm):e.$emit("on-fail-valid")})),!1},handleCancel:function(){this.$emit("on-cancel"),this.resetForm()},resetForm:function(){this.$refs.materialForm.resetFields()}}}),p=f,h=a("5d22"),g=Object(h["a"])(p,c,d,!1,null,null,null),v=g.exports,b={name:"material-modal",props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},formfields:{type:Object,default:function(){}}},components:{MaterialForm:v},data:function(){return{}},methods:{handleSubmit:function(e){this.$emit("handleOk",e)},handleCancel:function(){this.$emit("handleCancel")}}},y=b,S=Object(h["a"])(y,o,u,!1,null,"bdc48bf6",null),F=S.exports,L=a("7736"),x={name:"material-list",props:{materialName:{type:String,default:null},searchname:{type:String,default:null}},components:{MaterialModal:F},data:function(){return{modalVisible:!1,modalLoading:!1,editItem:null,dataloading:!1,dataSourse:[],pagination:{pageSize:8}}},computed:{modalTitle:function(){return this.editItem?"编辑资源":"创建资源"},searchList:function(){var e=this,t=[];return t=this.searchname?this.dataSourse.filter((function(t){return-1!=t.materialTitle.indexOf(e.searchname)})):this.dataSourse,t}},created:function(){this.getMaterialList()},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(L["c"])(["setMaterialCurrentId","setMaterialCurrentItem"])),Object(L["b"])(["getStoreMaterialList","addStoreMaterial","editStoreMaterial","closeStoreMaterial"])),{},{getMaterialList:function(){var e=this;e.dataloading=!0,e.dataSourse=[],e.getStoreMaterialList({}).then((function(t){e.dataloading=!1,e.dataSourse=t.dataList}))},handleMaterialCreate:function(){this.editItem=null,this.modalVisible=!0},handleMaterialEdit:function(e){this.editItem=e,this.modalVisible=!0},handleOk:function(e){var t=this;t.modalLoading=!0,t.editItem?t.setStoreMaterialEdit(e).then((function(e){t.modalLoading=!1,t.modalVisible=!1,t.msgsuccess("修改成功！")})):t.setStoreMaterialAdd(e).then((function(e){t.modalLoading=!1,t.modalVisible=!1,t.msgsuccess("添加成功！")}))},handleCancel:function(){this.modalVisible=!1},handleMaterialInfo:function(e){}}),watch:{materialName:function(e,t){this.getMaterialList()}}},C=x,w=(a("3c1b"),Object(h["a"])(C,s,n,!1,null,"a2c0ac88",null)),I=w.exports,$={name:"material-index",components:{MaterialList:I},data:function(){return{searchname:null,tabList:[{label:"系统资源",name:"materialAll",status:null},{label:"我的资源",name:"materialMy",status:null}]}},computed:{courseTabActive:function(){return this.winhash||"materialAll"},courseTabActiveItem:function(){var e=this;return this.tabList.find((function(t){return t.name==e.courseTabActive}))}},mounted:function(){},methods:{handleTab:function(e){var t=this;t.searchname=null,t.$router.push({hash:e})},handleMaterialCreate:function(){this.$refs.materiallist.handleMaterialCreate()}}},_=$,k=Object(h["a"])(_,i,l,!1,null,null,null);t["default"]=k.exports},"3c1b":function(e,t,a){"use strict";a("7a1e")},"3fed":function(e,t,a){},"4e1e":function(e,t,a){"use strict";a("3fed")},"7a1e":function(e,t,a){},a2e0:function(e,t,a){"use strict";a("b5f4")},b5f4:function(e,t,a){}}]);