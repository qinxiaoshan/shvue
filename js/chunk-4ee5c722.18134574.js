(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ee5c722"],{"00db":function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return h}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sh-upload"},[a("Input",{staticStyle:{display:"none"},attrs:{type:"text",value:t.value}}),t._l(t.uploadList,(function(e,i){return a("div",{key:i,staticClass:"uploadlist",style:t.upStyles},["finished"===e.status?[a("img",{attrs:{src:t.$config.baseUrl.dev+e.response.content}}),a("div",{staticClass:"uploadlistcover"},[a("Icon",{attrs:{type:"ios-eye-outline"},on:{click:function(a){return t.handleView(t.$config.baseUrl.dev+e.response.content)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},on:{click:function(a){return t.handleRemove(e)}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,showInfo:!1}}):t._e()]],2)})),a("div",{directives:[{name:"show",rawName:"v-show",value:t.uploadList.length<t.filelength,expression:"uploadList.length < filelength"}]},[a("Upload",{ref:"upload",staticClass:"imageupload",attrs:{multiple:t.multiple,name:t.filename,"show-upload-list":!1,"on-success":t.handleSuccess,"on-error":t.handleError,accept:t.uploadaccept,format:t.messageAll.fileFormat,"before-upload":t.handleBeforeUpload,action:t.baseUpload}},[a("div",{staticClass:"sh-uploadwrapper",style:t.upStyles},[a("Icon",{attrs:{type:"md-camera"}})],1)])],1),a("Modal",{attrs:{title:"查看图片",footer:null},on:{"on-cancel":t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:t.imgUrl}}):t._e()])],2)},l=[],s=(a("24a8"),a("5b12"),a("9b5f"),a("3bae"),a("4200"),a("bf2f"),a("1d43"),{props:{multiple:Boolean,value:{type:String,default:""},filename:{type:String,default:"image"},fileaccept:{type:String,default:"jpg,jpeg,png"},filelength:{type:Number,default:1},width:{type:Number,default:80},height:{type:Number,default:80}},name:"sh-img-upload",data:function(){return{baseUpload:this.$config.baseUrl.dev+"/putFile",imgName:"",imgUrl:"",visible:!1,resultUrl:"",uploadList:[]}},created:function(){},mounted:function(){},computed:{upStyles:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}},messageAll:function(){return{limitBytes:2097152,fileSizeError:"图片大小不能超过2M",fileFormat:this.fileaccept.split(","),fileTypeError:"图片格式不正确，请上传"+this.fileaccept+"文件"}},uploadaccept:function(){var t=[];return this.fileaccept.split(",").forEach((function(e){t.push("."+e)})),t.join(",")}},methods:{handleView:function(t){this.imgUrl=t,this.visible=!0},handleCancel:function(){this.visible=!1},handleRemove:function(t){var e=this,a=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(a.indexOf(t),1),this.$nextTick((function(){e.uploadList=[],e.resultUrl=""}))},handleSuccess:function(t,e){var a=this;"200"==t.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.resultUrl=a.uploadList[0].response.content})):0==t.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.resultUrl=t.path})):(this.$nextTick((function(){a.$refs.upload.fileList=[],a.uploadList=[],a.resultUrl=""})),this.msgwarning({content:t.content?t.content:"上传失败！"}))},handleError:function(t,e,a){this.msgerror("上传失败！")},handleBeforeUpload:function(t){var e=t.name.substr(t.name.lastIndexOf(".")).toLowerCase(),a=e.split(".")[1],i=this.messageAll.fileFormat,l=i.some((function(t){return t===a}));if(""!=this.fileaccept&&!l)return this.msginfo({content:this.messageAll.fileTypeError}),!1;var s=t.size<this.messageAll.limitBytes;return!!s||(this.msginfo({content:this.messageAll.fileSizeError}),!1)},handleUpload:function(t){var e=this,a=new FormData;a.append("file",t),uploadImgOne(a).then((function(t){e.handleSuccess(t)}))}},watch:{value:{handler:function(t,e){t&&(this.uploadList=[{status:"finished",response:{content:t}}],this.resultUrl=t)},immediate:!0},resultUrl:function(t){this.$emit("input",t)}}}),n=s,r=(a("56c3"),a("5d22")),o=Object(r["a"])(n,i,l,!1,null,"ac8968d4",null),c=o.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sh-upload"},[a("Input",{staticStyle:{display:"none"},attrs:{type:"text",value:t.inputVal}}),t.uploadList.length>0?t._l(t.uploadList,(function(e,i){return a("div",{key:i,staticClass:"uploadlist uploadlistfile",style:t.upStyles},["finished"===e.status?[a("div",{staticClass:"uploadlist-item"},[a("div",{staticClass:"title"},[t._v(t._s(e.response.content))]),a("Icon",{attrs:{type:"ios-trash-outline",title:"删除文件",size:"18"},on:{click:function(a){return t.handleRemove(e)}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,showInfo:!1}}):t._e()]],2)})):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.uploadList.length<t.maxfilelength,expression:"uploadList.length < maxfilelength"}]},[a("Upload",{ref:"upload",staticClass:"fileupload",attrs:{multiple:t.multiple,name:t.filename,"show-upload-list":!1,"on-success":t.handleSuccess,"on-error":t.handleError,accept:t.uploadaccept,format:t.messageAll.fileFormat,"before-upload":t.handleBeforeUpload,action:t.baseUpload}},[a("div",{staticClass:"sh-uploadwrapper",style:t.upStyles},[a("Icon",{attrs:{type:"md-add"}})],1)])],1)],2)},d=[],m={props:{multiple:Boolean,disabled:Boolean,value:{type:[String,Array],default:""},filename:{type:String,default:"image"},fileaccept:{type:String,default:""},maxfilelength:{type:Number,default:3},width:{type:Number,default:60},height:{type:Number,default:60}},name:"sh-file-upload",data:function(){return{baseUpload:this.$config.baseUrl.dev+"/putFile",visible:!1,uploadList:[],resultUrl:[]}},created:function(){},mounted:function(){},computed:{inputVal:function(){return this.resultUrl.length>0?JSON.stringify(this.resultUrl):void 0},upStyles:function(){return{minWidth:"".concat(this.width,"px"),minHeight:"".concat(this.height,"px")}},messageAll:function(){return{limitBytes:20971520,fileSizeError:"文件大小不能超过20M",fileType:this.fileaccept.split(","),fileTypeError:"文件格式不正确，请上传"+this.fileaccept+"文件"}},uploadaccept:function(){var t=[];return this.fileaccept.split(",").forEach((function(e){t.push("."+e)})),t.join(",")}},methods:{handleRemove:function(t){var e=this.$refs.upload.fileList,a=e.indexOf(t);this.$refs.upload.fileList.splice(a,1),this.uploadList.splice(a,1),this.resultUrl.splice(a,1)},handleBeforeUpload:function(t){var e=t.name.substr(t.name.lastIndexOf(".")).toLowerCase(),a=e.split(".")[1],i=this.messageAll.fileType,l=i.some((function(t){return t===a}));if(""!=this.fileaccept&&!l)return this.msginfo({content:this.messageAll.fileTypeError}),!1;var s=t.size<this.messageAll.limitBytes;return!!s||(this.msginfo({content:this.messageAll.fileSizeError}),!1)},handleSuccess:function(t,e){var a=this;"200"==t.status?this.$nextTick((function(){a.uploadList=a.$refs.upload.fileList,a.uploadList.forEach((function(t){a.resultUrl.push(t.response.content)}))})):this.msgwarning({content:t.content?t.content:"上传失败！"})},handleError:function(t,e,a){this.msgerror("上传失败！")},blur:function(){this.$refs.input.blur()}},watch:{value:{handler:function(t,e){var a=this;t&&(this.uploadList=[],t.forEach((function(t){a.uploadList.push({status:"finished",response:{content:t}})})),this.resultUrl=t)},immediate:!0},resultUrl:function(t){this.$emit("input",t)}}},f=m,p=(a("4c54"),Object(r["a"])(f,u,d,!1,null,"42c98569",null)),h=p.exports},"0740":function(t,e,a){},"1cc1":function(t,e,a){},"1d04":function(t,e,a){"use strict";a("1cc1")},"25eb":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sh-content"},[a("div",{staticClass:"container"},[a("ShHeader",{attrs:{type:"border",title:"素材管理",ghost:""}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("Form",{attrs:{inline:""}},[a("FormItem",{staticClass:"mb-0"},[a("Input",{directives:[{name:"input-filter",rawName:"v-input-filter"}],attrs:{type:"text",search:"",placeholder:"请输入资源名称",clearable:""},model:{value:t.searchname,callback:function(e){t.searchname="string"===typeof e?e.trim():e},expression:"searchname"}})],1),"materialMy"==t.courseTabActive?a("FormItem",{staticClass:"mb-0 mr-0"},[a("Button",{attrs:{type:"primary"},on:{click:t.handleMaterialCreate}},[t._v("添加资源")])],1):t._e()],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"sh-content-bg1"},[a("Tabs",{staticClass:"sh-tab reverse",attrs:{value:t.courseTabActive},on:{"on-click":t.handleTab}},t._l(t.tabList,(function(t,e){return a("TabPane",{key:e,attrs:{label:t.label,name:t.name}})})),1),a("div",{staticClass:"px-4"},[a("MaterialList",{ref:"materiallist",attrs:{searchname:t.searchname,materialName:t.courseTabActive}})],1)],1)])])],1)])},l=[],s=(a("4cd5"),a("1d43"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ShList",{attrs:{grid:{gutter:20,xs:24,sm:12,md:8,lg:6},dataSourse:t.searchList,loading:t.dataloading,pagination:t.pagination},scopedSlots:t._u([{key:"renderItem",fn:function(e){var i=e[0];return a("ListItem",{},[a("div",{staticClass:"materialitem"},[a("div",{staticClass:"image"},[a("img",{attrs:{src:i.materialImage}})]),a("div",{staticClass:"content"},[a("div",{staticClass:"header"},[t._v(t._s(i.materialTitle))]),a("div",{staticClass:"meta"},[a("span",{},[t._v("资源类型："+t._s(i.materialType))])]),a("div",{staticClass:"description"},[t._v(t._s(i.materialIntroduce))])]),a("div",{staticClass:"footer"},[a("Button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(e){return t.handleMaterialEdit(i)}}},[t._v("编辑")]),a("Button",{attrs:{type:"default",size:"small"},nativeOn:{click:function(e){return t.handleMaterialInfo(i)}}},[t._v("查看")])],1)])])}}])}),a("MaterialModal",{attrs:{title:t.modalTitle,formfields:t.editItem,loading:t.modalLoading,visible:t.modalVisible},on:{handleCancel:t.handleCancel,handleOk:t.handleOk}})],1)}),n=[],r=a("6abc"),o=(a("e3b5"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{width:"900px",value:t.visible,title:t.title,"mask-closable":!1,loading:!0,"footer-hide":""},on:{"on-cancel":t.handleCancel}},[a("ShLoading",{attrs:{loading:t.loading}}),t.visible?a("MaterialForm",{staticStyle:{"max-width":"700px",margin:"20px auto"},attrs:{formfields:t.formfields},on:{"on-success-valid":t.handleSubmit,"on-cancel":t.handleCancel}}):t._e()],1)],1)}),c=[],u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"materialForm",staticClass:"materialForm",attrs:{model:t.materialform,rules:t.materialrules,"label-width":130,"label-colon":""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSubmit(e)}}},[a("FormItem",{attrs:{label:"资源封面",prop:"materialImage"}},[a("ShImgUpload",{attrs:{width:260,height:150},model:{value:t.materialform.materialImage,callback:function(e){t.$set(t.materialform,"materialImage","string"===typeof e?e.trim():e)},expression:"materialform.materialImage"}})],1),a("FormItem",{attrs:{label:"资源名称",prop:"materialTitle"}},[a("Input",{directives:[{name:"input-filter",rawName:"v-input-filter:trim",arg:"trim"}],attrs:{size:t.size,placeholder:"请输入资源名称"},model:{value:t.materialform.materialTitle,callback:function(e){t.$set(t.materialform,"materialTitle","string"===typeof e?e.trim():e)},expression:"materialform.materialTitle"}})],1),a("FormItem",{attrs:{label:"资源类型",prop:"materialTypes"}},[a("Select",{attrs:{size:t.size,placeholder:"请选择资源类型"},model:{value:t.materialform.materialTypes,callback:function(e){t.$set(t.materialform,"materialTypes","string"===typeof e?e.trim():e)},expression:"materialform.materialTypes"}},[a("Option",{attrs:{value:"1"}},[t._v("1")]),a("Option",{attrs:{value:"2"}},[t._v("2")])],1)],1),a("FormItem",{attrs:{label:"是否对学生公开",prop:"materialPublic"}},[a("RadioGroup",{model:{value:t.materialform.materialPublic,callback:function(e){t.$set(t.materialform,"materialPublic","string"===typeof e?e.trim():e)},expression:"materialform.materialPublic"}},[a("Radio",{staticClass:"mr-4",attrs:{label:1}},[t._v("是")]),a("Radio",{staticClass:"mr-4",attrs:{label:2}},[t._v("否")])],1)],1),a("FormItem",{attrs:{label:"附件上传",prop:"materialFiles"}},[a("ShFileUpload",{model:{value:t.materialform.materialFiles,callback:function(e){t.$set(t.materialform,"materialFiles","string"===typeof e?e.trim():e)},expression:"materialform.materialFiles"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary",size:t.size},on:{click:t.handleSubmit}},[t._v("确定")]),a("Button",{attrs:{type:"default",size:t.size},on:{click:t.handleCancel}},[t._v("取消")])],1)],1)],1)},d=[],m=(a("3bae"),a("62f9"),a("00db")),f=(a("0740"),{name:"material-form",props:{size:{type:String,default:"default"},formfields:{type:Object,default:function(){}}},components:{ShImgUpload:m["b"],ShFileUpload:m["a"]},data:function(){return{materialform:{materialImage:null,materialTitle:null,materialTypes:null,materialPublic:null,materialFiles:[]}}},computed:{materialrules:function(){return{materialImage:[{required:!0,type:"string",message:"请选择资源封面",trigger:"change"}],materialTitle:[{required:!0,type:"string",message:"请输入资源名称",trigger:"blur"}],materialTypes:[{required:!0,type:"string",message:"请选择资源类型",trigger:"change"}],materialPublic:[{required:!0,type:"number",message:"请选择是否对学生公开",trigger:"change"}],materialFiles:[{required:!0,type:"array",message:"请上传附件",trigger:"change"}]}}},mounted:function(){this.readEditFields()},methods:{readEditFields:function(){var t=this;if(void 0==this.formfields)return!1;Object.keys(this.materialform).forEach((function(e){t.formfields[e]&&(t.materialform[e]=t.formfields[e])}))},handleSubmit:function(){var t=this;return t.$refs.materialForm.validate((function(e){e?t.$emit("on-success-valid",t.materialform):t.$emit("on-fail-valid")})),!1},handleCancel:function(){this.$emit("on-cancel"),this.resetForm()},resetForm:function(){this.$refs.materialForm.resetFields()}}}),p=f,h=a("5d22"),g=Object(h["a"])(p,u,d,!1,null,null,null),v=g.exports,b={name:"material-modal",props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},formfields:{type:Object,default:function(){}}},components:{MaterialForm:v},data:function(){return{}},methods:{handleSubmit:function(t){this.$emit("handleOk",t)},handleCancel:function(){this.$emit("handleCancel")}}},y=b,S=Object(h["a"])(y,o,c,!1,null,"bdc48bf6",null),L=S.exports,C=a("7736"),x={name:"material-list",props:{materialName:{type:String,default:null},searchname:{type:String,default:null}},components:{MaterialModal:L},data:function(){return{modalVisible:!1,modalLoading:!1,editItem:null,dataloading:!1,dataSourse:[],pagination:{pageSize:8}}},computed:{modalTitle:function(){return this.editItem?"编辑资源":"创建资源"},searchList:function(){var t=this,e=[];return e=this.searchname?this.dataSourse.filter((function(e){return-1!=e.materialTitle.indexOf(t.searchname)})):this.dataSourse,e}},created:function(){this.getMaterialList()},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(C["c"])(["setMaterialCurrentId","setMaterialCurrentItem"])),Object(C["b"])(["getStoreMaterialList","addStoreMaterial","editStoreMaterial","closeStoreMaterial"])),{},{getMaterialList:function(){var t=this;t.dataloading=!0,t.dataSourse=[],t.getStoreMaterialList({}).then((function(e){t.dataloading=!1,t.dataSourse=e.dataList}))},handleMaterialCreate:function(){this.editItem=null,this.modalVisible=!0},handleMaterialEdit:function(t){this.editItem=t,this.modalVisible=!0},handleOk:function(t){var e=this;e.modalLoading=!0,e.editItem?e.setStoreMaterialEdit(t).then((function(t){e.modalLoading=!1,e.modalVisible=!1,e.msgsuccess("修改成功！")})):e.setStoreMaterialAdd(t).then((function(t){e.modalLoading=!1,e.modalVisible=!1,e.msgsuccess("添加成功！")}))},handleCancel:function(){this.modalVisible=!1},handleMaterialInfo:function(t){}}),watch:{materialName:function(t,e){this.getMaterialList()}}},I=x,w=(a("1d04"),Object(h["a"])(I,s,n,!1,null,"40b10f3b",null)),$=w.exports,_={name:"material-index",components:{MaterialList:$},data:function(){return{searchname:null,tabList:[{label:"系统资源",name:"materialAll",status:null},{label:"我的资源",name:"materialMy",status:null}]}},computed:{courseTabActive:function(){return this.winhash||"materialAll"},courseTabActiveItem:function(){var t=this;return this.tabList.find((function(e){return e.name==t.courseTabActive}))}},mounted:function(){},methods:{handleTab:function(t){var e=this;e.searchname=null,e.$router.push({hash:t})},handleMaterialCreate:function(){this.$refs.materiallist.handleMaterialCreate()}}},k=_,T=Object(h["a"])(k,i,l,!1,null,null,null);e["default"]=T.exports},4200:function(t,e,a){"use strict";var i=a("1f04"),l=a("4f06"),s=a("b7d9"),n=a("d714"),r=[].join,o=l!=Object,c=n("join",",");i({target:"Array",proto:!0,forced:o||!c},{join:function(t){return r.call(s(this),void 0===t?",":t)}})},"4c54":function(t,e,a){"use strict";a("8cd7")},"56c3":function(t,e,a){"use strict";a("aea9")},"8cd7":function(t,e,a){},aea9:function(t,e,a){}}]);